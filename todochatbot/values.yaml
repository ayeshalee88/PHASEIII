# Default values for todochatbot
# This is a YAML-formatted file for Minikube local deployment

# Global settings
global:
  imageRegistry: ""
  storageClass: "standard"

# PostgreSQL Configuration
postgresql:
  enabled: true
  name: postgresql
  image:
    repository: postgres
    tag: "15-alpine"
    pullPolicy: IfNotPresent
  auth:
    postgresPassword: "postgres"
    database: "todoapp"
    username: "postgres"
  primary:
    persistence:
      enabled: true
      size: 1Gi
      storageClass: "standard"
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi
  service:
    type: ClusterIP
    port: 5432

# Backend Configuration (FastAPI)
backend:
  enabled: true
  name: backend
  image:
    repository: phase3-backend
    tag: "latest"
    pullPolicy: IfNotPresent
  replicaCount: 1
  service:
    type: ClusterIP
    port: 8000
    targetPort: 8000
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  env:
    SECRET_KEY: "your-secret-key-change-in-production"
    ACCESS_TOKEN_EXPIRE_MINUTES: "30"
    ALGORITHM: "HS256"
  startupProbe:
    httpGet:
      path: /
      port: 8000
    failureThreshold: 30
    periodSeconds: 10
  livenessProbe:
    httpGet:
      path: /
      port: 8000
    initialDelaySeconds: 60
    periodSeconds: 10
  readinessProbe:
    httpGet:
      path: /
      port: 8000
    initialDelaySeconds: 30
    periodSeconds: 5

# Frontend Configuration (Next.js)
frontend:
  enabled: true
  name: frontend
  image:
    repository: phase3-frontend
    tag: "latest"
    pullPolicy: IfNotPresent
  replicaCount: 1
  service:
    type: NodePort  # Use NodePort for Minikube access
    port: 3000
    targetPort: 3000
    nodePort: 30080  # Accessible via http://localhost:30080
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  env:
    NEXT_PUBLIC_API_URL: "http://localhost:8000"
    NODE_ENV: "production"
  livenessProbe:
    httpGet:
      path: /
      port: 3000
    initialDelaySeconds: 30
    periodSeconds: 10
  readinessProbe:
    httpGet:
      path: /
      port: 3000
    initialDelaySeconds: 5
    periodSeconds: 5

# Ingress Configuration (optional)
ingress:
  enabled: false
  className: "nginx"
  annotations: {}
  hosts:
    - host: todochatbot.local
      paths:
        - path: /
          pathType: Prefix
          serviceName: frontend
          servicePort: 3000
        - path: /api
          pathType: Prefix
          serviceName: backend
          servicePort: 8000
  tls: []

# Service Account
serviceAccount:
  create: true
  name: todochatbot-sa
  annotations: {}

# Pod Security Context
podSecurityContext:
  fsGroup: 1000

# Security Context
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  readOnlyRootFilesystem: false
  allowPrivilegeEscalation: false

# Node Selector for Minikube
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}
